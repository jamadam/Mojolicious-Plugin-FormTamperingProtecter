=head1 NAME

Mojolicious::Plugin::FormValidatorLazy - FormValidatorLazy

=head1 SYNOPSIS

    plugin form_validator_lazy => {
        token_key_prefix => 'form_validator_lazy',
        action => ['/receptor1'],
        blackhole => sub {
            $_[0]->res->code(400);
            $_[0]->render(text => 'An error occured');
        },
    };

=head1 DESCRIPTION

B<This software is considered to be alpha quality and isn't recommended for
regular usage.>

Mojolicious::Plugin::FormValidatorLazy is a Mojolicious plugin for validating
post data with auto-generated validation rules. The plugin generates validation
rules based on DOM structure and catch the errors.

The plugin detects following error for now.

=over

=item Unknown form fields.

The form fields represented by name attribute are all white listed and post data
injected unknown fields are blocked.

=item Unknown values of selectable fields.

Selectable values of checkboxes, radio buttons and select options are white
listed and unknow values are blocked. 

=item Hidden field tamperings.

Hidden typed input can't be ommited and the value takes only one option. the
plugin blocks values against the rule.

=item Values against maxlength attributes.

Values violating of maxlength are blocked.

=item HTML5 validation attributes

HTML5 supports some validation attributes such as [required], [pattern=*],
[type=number], [min=*], [max=*]. The plugin detects them and block violations.

=back

=head2 CLASS METHODS

=head3 inject_digest

Generates a digest strings of form structure for each forms in mojo response
and inject them into itself.

    my $html = inject_digest($res, ['/path1', '/path2'], $token_key, $secret);

=head3 validate_form

Validates form data of given mojo request by given digest.

    my $error = validate_form($creq, $digest, $secret);

=head2 OPTIONS

=head1 AUTHOR

Sugama Keita, E<lt>sugama@jamadam.comE<gt>

=head1 COPYRIGHT AND LICENSE

Copyright (C) 2011 by Sugama Keita.

This program is free software; you can redistribute it and/or
modify it under the same terms as Perl itself.

=cut
